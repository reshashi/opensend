; =============================================================================
; MailForge Haraka TLS Configuration
; =============================================================================
;
; TLS/SSL configuration for encrypted connections.
; You must provide valid certificates for production use.
;
; Certificate Setup:
;   1. Use Let's Encrypt: certbot certonly --standalone -d mail.yourdomain.com
;   2. Copy certificates to ./keys/ directory
;   3. Update paths below or mount to /app/keys/
;
; See: https://haraka.github.io/manual/plugins/tls.html
;

[main]
; Enable STARTTLS (upgrades plain connection to encrypted)
; This is the standard method for port 25 and 587
starttls=true

; Private key file path
key=/app/keys/tls-key.pem

; Certificate file path (include full chain for production)
cert=/app/keys/tls-cert.pem

; Optional: CA bundle for intermediate certificates
; ca=/app/keys/tls-ca.pem

; Force TLS for submission port (587)
; Connections on port 587 will require STARTTLS before commands
require_tls=false

[options]
; Minimum TLS version (1.2 is recommended minimum)
minVersion=TLSv1.2

; Cipher suites (modern, secure ciphers only)
; Use 'openssl ciphers -v' to see available ciphers
ciphers=ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384

; Prefer server cipher order
honorCipherOrder=true

; Enable OCSP stapling (improves performance)
; Note: Requires properly configured CA chain
enableOCSP=false

[outbound]
; Enable TLS for outbound connections
enable=true

; Require TLS for outbound (may cause delivery failures to legacy servers)
; Only enable if you're certain all recipients support TLS
require=false

; Upgrade to TLS if available (opportunistic TLS)
; This is the recommended setting for maximum compatibility
upgrade=true

; Verify remote certificates
; WARNING: Many mail servers have invalid/expired certificates
; Set to false for maximum deliverability
verify=false

; Force specific TLS version for outbound (leave empty for auto)
; minVersion=TLSv1.2

[inbound]
; Require clients to use TLS (may break compatibility)
; Only enable if all senders support TLS
require=false

; Verification mode for client certificates
; none = don't request client cert
; request = request but don't require
; require = require valid client cert
clientCertificateMode=none

[no_tls_hosts]
; Hosts that should never use TLS (due to known issues)
; Add hosts that have broken TLS implementations
; Example: broken-mail.example.com

[ocsp]
; OCSP configuration (if enableOCSP=true above)
; staple=true
; responder_url=http://ocsp.example.com
