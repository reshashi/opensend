; =============================================================================
; MailForge Haraka SMTP Configuration
; =============================================================================
;
; This is the main Haraka configuration file.
; For more options, see: https://haraka.github.io/manual/CoreConfig.html
;

[main]
; Listen on all interfaces for ports 25 (SMTP) and 587 (Submission)
listen=[::]:25,[::]:587

; Nodes - number of worker processes (0 = auto-detect based on CPU cores)
nodes=0

; Cluster mode for better performance
daemonize=false

; Maximum concurrent connections
max_connections=500

; Connection timeout (seconds)
disconnect_timeout=30

[headers]
; File containing valid hostnames for this server
host_list=host_list

; Add received headers
add_received=true

; Show software version in headers (disable in production for security)
show_version=false

[outbound]
; Enable TLS for outbound connections
enable_tls=true

; Concurrency settings
concurrency_max=100

; Queue directory
queue_dir=/app/queue

; Retry schedule (comma-separated list of delay in seconds)
; Retries at: 1min, 5min, 15min, 30min, 1hr, 2hr, 4hr, 8hr
maxTempFailures=8
retry_schedule=60,300,900,1800,3600,7200,14400,28800

; Bounce settings
bounce_message=true
late_bounce=true

[relay]
; Only relay for authenticated users or from trusted networks
; This is handled by the auth plugin

[inbound]
; Maximum message size (25MB)
max_message_size=26214400

; Maximum line length
max_line_length=16384

; Maximum data line length
max_data_line_length=16384

; Maximum received count (prevent mail loops)
max_received_count=100

[logging]
; Log level: LOGDATA, LOGPROTOCOL, LOGDEBUG, LOGERROR, LOGINFO, LOGNOTICE, LOGWARN, LOGCRIT
level=LOGINFO

; Log to stdout for Docker
syslog=false

; Timestamps in logs
timestamps=true

[auth]
; Authentication methods
methods=LOGIN,PLAIN

; Require TLS before auth
requireTLS=true

[helo.checks]
; Reject connections with invalid HELO/EHLO
reject_invalid=true
reject_no_ptr=false
