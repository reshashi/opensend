; =============================================================================
; MailForge Haraka Plugin Configuration
; =============================================================================
;
; This file configures the MailForge custom plugin that integrates Haraka
; with the MailForge API for domain verification, DKIM signing, and
; delivery status reporting.
;
; Environment variables can override these settings:
;   MAILFORGE_API_URL - API server URL
;   DATABASE_URL - Direct database connection
;

[main]
; MailForge API URL for domain verification and status updates
; Default: http://api:3000 (Docker internal network)
api_url=http://api:3000

; API request timeout in milliseconds
api_timeout=5000

; Enable debug logging
debug=false

[cache]
; Domain configuration cache TTL in seconds
domain_ttl=300

; Suppression list cache TTL in seconds
suppression_ttl=60

; Maximum cache size (number of entries)
max_size=10000

[dkim]
; Enable DKIM signing via MailForge (domain-specific keys from database)
enabled=true

; Fallback to default key if domain key not found
fallback_enabled=false

; Default selector (used with fallback key)
default_selector=mailforge

; Headers to sign
headers=from,to,subject,date,message-id,mime-version,content-type

[suppression]
; Enable suppression list checking
enabled=true

; Action for suppressed addresses: reject, discard, or tag
action=reject

; Custom rejection message
reject_message=This recipient has been unsubscribed or marked as bounced

[rate_limiting]
; Enable per-API-key rate limiting
enabled=false

; Default rate limit if not specified in API key
default_rate=100

; Rate limit window in seconds
window=1

[status_reporting]
; Enable delivery status reporting back to API
enabled=true

; Report successful deliveries
report_delivered=true

; Report bounces
report_bounced=true

; Report deferrals (temporary failures)
report_deferred=true

; Batch status updates (reduces API calls)
batch_updates=false
batch_size=100
batch_interval=5000

[headers]
; Add custom headers to outgoing messages
add_mailforge_id=true

; Header name for MailForge message ID
message_id_header=X-MailForge-ID

; Add processing timestamp
add_timestamp=true

[logging]
; Log level for mailforge plugin: debug, info, warn, error
level=info

; Log API requests
log_api_requests=false

; Log cache hits/misses
log_cache=false
